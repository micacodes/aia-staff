{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport PermissionsAndroid from \"react-native-web/dist/exports/PermissionsAndroid\";\nimport messaging from \"@react-native-firebase/messaging\";\nimport { createNotificationChannels, displayNotification } from \"./notifee\";\nvar requestUserPermissions = function () {\n  var _ref = _asyncToGenerator(function* () {\n    var status = yield PermissionsAndroid.request(PermissionsAndroid.PERMISSIONS.POST_NOTIFICATIONS);\n    return status === \"granted\";\n  });\n  return function requestUserPermissions() {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar registerBackgroundMessageHandler = function registerBackgroundMessageHandler() {\n  messaging().setBackgroundMessageHandler(onMessage);\n};\nvar registerForegroundMessageHandler = function registerForegroundMessageHandler() {\n  var unsubscribe = messaging().onMessage(onMessage);\n  return unsubscribe;\n};\nvar onMessage = function () {\n  var _ref2 = _asyncToGenerator(function* (message) {\n    var notification = {\n      title: message.notification.title,\n      body: message.notification.body,\n      data: message.data\n    };\n    yield displayNotification(notification);\n  });\n  return function onMessage(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar getFCMToken = function () {\n  var _ref3 = _asyncToGenerator(function* () {\n    return yield messaging().getToken();\n  });\n  return function getFCMToken() {\n    return _ref3.apply(this, arguments);\n  };\n}();\nvar onAppBootstrap = function () {\n  var _ref4 = _asyncToGenerator(function* () {\n    yield messaging().registerDeviceForRemoteMessages();\n    yield createNotificationChannels();\n    registerBackgroundMessageHandler();\n  });\n  return function onAppBootstrap() {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport { onMessage, requestUserPermissions, registerForegroundMessageHandler, getFCMToken, onAppBootstrap };","map":{"version":3,"names":["messaging","createNotificationChannels","displayNotification","requestUserPermissions","_ref","_asyncToGenerator","status","PermissionsAndroid","request","PERMISSIONS","POST_NOTIFICATIONS","apply","arguments","registerBackgroundMessageHandler","setBackgroundMessageHandler","onMessage","registerForegroundMessageHandler","unsubscribe","_ref2","message","notification","title","body","data","_x","getFCMToken","_ref3","getToken","onAppBootstrap","_ref4","registerDeviceForRemoteMessages"],"sources":["/home/micah/Documents/aia-staff-osen-main/utils/fcm.ts"],"sourcesContent":["import { PermissionsAndroid } from \"react-native\";\nimport messaging, {\n  FirebaseMessagingTypes,\n} from \"@react-native-firebase/messaging\";\nimport { createNotificationChannels, displayNotification } from \"./notifee\";\n\nconst requestUserPermissions = async (): Promise<boolean> => {\n  const status = await PermissionsAndroid.request(\n    PermissionsAndroid.PERMISSIONS.POST_NOTIFICATIONS\n  );\n\n  return status === \"granted\";\n};\n\nconst registerBackgroundMessageHandler = () => {\n  messaging().setBackgroundMessageHandler(onMessage);\n};\n\nconst registerForegroundMessageHandler = (): VoidFunction => {\n  const unsubscribe = messaging().onMessage(onMessage);\n\n  return unsubscribe;\n};\n\nconst onMessage = async (message: FirebaseMessagingTypes.RemoteMessage) => {\n  const notification = {\n    title: message.notification.title,\n    body: message.notification.body,\n    data: message.data,\n  };\n\n  await displayNotification(notification);\n};\n\nconst getFCMToken = async (): Promise<string> => {\n  return await messaging().getToken();\n};\n\nconst onAppBootstrap = async () => {\n  await messaging().registerDeviceForRemoteMessages();\n  await createNotificationChannels();\n\n  registerBackgroundMessageHandler();\n};\n\nexport {\n  onMessage,\n  requestUserPermissions,\n  registerForegroundMessageHandler,\n  getFCMToken,\n  onAppBootstrap,\n};\n"],"mappings":";;AACA,OAAOA,SAAS,MAET,kCAAkC;AACzC,SAASC,0BAA0B,EAAEC,mBAAmB;AAExD,IAAMC,sBAAsB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,aAA8B;IAC3D,IAAMC,MAAM,SAASC,kBAAkB,CAACC,OAAO,CAC7CD,kBAAkB,CAACE,WAAW,CAACC,kBACjC,CAAC;IAED,OAAOJ,MAAM,KAAK,SAAS;EAC7B,CAAC;EAAA,gBANKH,sBAAsBA,CAAA;IAAA,OAAAC,IAAA,CAAAO,KAAA,OAAAC,SAAA;EAAA;AAAA,GAM3B;AAED,IAAMC,gCAAgC,GAAG,SAAnCA,gCAAgCA,CAAA,EAAS;EAC7Cb,SAAS,CAAC,CAAC,CAACc,2BAA2B,CAACC,SAAS,CAAC;AACpD,CAAC;AAED,IAAMC,gCAAgC,GAAG,SAAnCA,gCAAgCA,CAAA,EAAuB;EAC3D,IAAMC,WAAW,GAAGjB,SAAS,CAAC,CAAC,CAACe,SAAS,CAACA,SAAS,CAAC;EAEpD,OAAOE,WAAW;AACpB,CAAC;AAED,IAAMF,SAAS;EAAA,IAAAG,KAAA,GAAAb,iBAAA,CAAG,WAAOc,OAA6C,EAAK;IACzE,IAAMC,YAAY,GAAG;MACnBC,KAAK,EAAEF,OAAO,CAACC,YAAY,CAACC,KAAK;MACjCC,IAAI,EAAEH,OAAO,CAACC,YAAY,CAACE,IAAI;MAC/BC,IAAI,EAAEJ,OAAO,CAACI;IAChB,CAAC;IAED,MAAMrB,mBAAmB,CAACkB,YAAY,CAAC;EACzC,CAAC;EAAA,gBARKL,SAASA,CAAAS,EAAA;IAAA,OAAAN,KAAA,CAAAP,KAAA,OAAAC,SAAA;EAAA;AAAA,GAQd;AAED,IAAMa,WAAW;EAAA,IAAAC,KAAA,GAAArB,iBAAA,CAAG,aAA6B;IAC/C,aAAaL,SAAS,CAAC,CAAC,CAAC2B,QAAQ,CAAC,CAAC;EACrC,CAAC;EAAA,gBAFKF,WAAWA,CAAA;IAAA,OAAAC,KAAA,CAAAf,KAAA,OAAAC,SAAA;EAAA;AAAA,GAEhB;AAED,IAAMgB,cAAc;EAAA,IAAAC,KAAA,GAAAxB,iBAAA,CAAG,aAAY;IACjC,MAAML,SAAS,CAAC,CAAC,CAAC8B,+BAA+B,CAAC,CAAC;IACnD,MAAM7B,0BAA0B,CAAC,CAAC;IAElCY,gCAAgC,CAAC,CAAC;EACpC,CAAC;EAAA,gBALKe,cAAcA,CAAA;IAAA,OAAAC,KAAA,CAAAlB,KAAA,OAAAC,SAAA;EAAA;AAAA,GAKnB;AAED,SACEG,SAAS,EACTZ,sBAAsB,EACtBa,gCAAgC,EAChCS,WAAW,EACXG,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}